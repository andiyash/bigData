# Лабораторная работая №1
## Яшакин Андрей группа 6132-010402D
### Задачи: 
В ходе лабораторной работы был выполнен ряд заданий по исследованию данных о поездках на велосипедах и станциях

**1. Найти велосипед с максимальным временем пробега.** 

![image](https://github.com/andiyash/bigData/assets/145579445/5f12a605-0de9-4827-b008-9c5119d0feda)

Данный запрос был выполнен с использованием DataFrame API

**2. Найти наибольшее геодезическое расстояние между станциями.**  

![image](https://github.com/andiyash/bigData/assets/145579445/f9d9f93d-82db-41b1-9eb3-d22ad3e20310)

Здесь определена функция calculate_distance, которая использует библиотеку geopy для вычисления геодезического расстояния между двумя координатами в километрах.

**3. Найти путь велосипеда с максимальным временем пробега через станции.**

DataFrame stationData фильтруется для получения данных только для стартовой и конечной станций велосипеда с максимальным временем поездки.

Создается новый DataFrame result_3, который содержит все возможные комбинации стартовых и конечных станций. Рассчитывается расстояние между ними с использованием ранее зарегистрированной UDF calculate_distance_udf. Затем выбираются только необходимые столбцы ("name", "end_station_name", "distance") и фильтруются строки, где начальная и конечная станции совпадают и расстояние равно 0.

![image](https://github.com/andiyash/bigData/assets/145579445/174c0652-2419-4683-8fc7-9532a205841a)

**4. Найти количество велосипедов в системе.**

![image](https://github.com/andiyash/bigData/assets/145579445/9c37d4dd-9a01-4f14-b72f-6cdc40480cf6)

Здесь происходит подсчет уникальных велосипедов в DataFrame tripData

**5. Найти пользователей потративших на поездки более 3 часов.**

![image](https://github.com/andiyash/bigData/assets/145579445/64b7cbbf-a67f-4538-b81d-e6975875da20)
